<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Immersio - Learning Ancient Languages Interactively</title>
  <link rel="stylesheet" type="text/css" href="css/normalize.css">
  <link rel="stylesheet" type="text/css" href="css/theme.css">
  <link rel="stylesheet" type="text/css" href="css/fa/css/all.css">
</head>
<body class="lessons">
	<header>
		<figure class="logo">
			<img src="imgs/logo-med.png">
		</figure>
	</header>

	<div id="main-content">
		<div id="wrapper" class="message_holder">
		</div>
	</div>

	<div id="reply">
		<div id="wrapper">

			<form method="POST">
			<input type="text" id="answer" name="answer" class="message" placeholder="Answer" autofocus>
			<button  class="send" type="submit">
				<i class="fas fa-paper-plane"></i>
			</button>
			</form>
		</div>
	</div>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
	<script>
            var ws = new WebSocket("ws://127.0.0.1:8765/");
            ws.onmessage = function (event) {
                var messages = document.getElementsByClassName('message_holder')[0],
                    message = document.createElement('div');
                    message.className += "dialog marcus active";
                var arrow = document.createElement('div');
                arrow.className += "left-arrow";
                var content = document.createElement("p");
                content.innerText = event.data;
                message.appendChild(content);
                messages.appendChild(message);
            };

            var form = $( 'form' ).on( 'submit', function( e ) {
		    e.preventDefault()
		    let user_input = $( 'input.message' ).val()
		    $( 'input.message' ).val( '' ).focus()
		    ws.send(user_input);
		    $( 'div.message_holder' ).append( 
		  		'<div class="dialog user active"><p>'+user_input+'</p><div class="right-arrow"></div></div>' )
		  	} )
        </script>
</body>
</html>